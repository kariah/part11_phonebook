(this.webpackJsonppuhelinluettelo=this.webpackJsonppuhelinluettelo||[]).push([[0],{20:function(e,n,t){},40:function(e,n,t){"use strict";t.r(n);var r=t(1),o=t.n(r),s=t(15),c=t.n(s),u=(t(20),t(3)),a=t(4),i=t.n(a),l="/api/persons",d={getAll:function(){return i.a.get(l).then((function(e){return e.data}))},create:function(e){return i.a.post(l,e).then((function(e){return e.data}))},update:function(e,n){return i.a.put("".concat(l,"/").concat(e),n).then((function(e){return e.data}))},remove:function(e){return i.a.delete("".concat(l,"/").concat(e)).then((function(e){return e.status}))}},f=t(5),b=t(0),j=function(e){var n=e.persons,t=e.showAll,o=e.setPersons,s=e.setShowAll,c=e.setInfoMessage,a=e.setErrorMessage,i=Object(r.useState)({person:{id:0,name:"",number:""}}),l=Object(u.a)(i,2),j=l[0],m=l[1],h=function(e){var n=j.person.name,t=j.person.number;"name"===e.target.id?n=e.target.value:"number"===e.target.id&&(t=e.target.value),m(Object(f.a)(Object(f.a)({},j),{},{person:{name:n,number:t}}))};return Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault();var r,u=null;if(void 0!==j.person.name&&null!=(u=n.find((function(e){return e.name===j.person.name})))&&(r=window.confirm("".concat(j.person.name," is already added to phonebook, replace the old number with new one"))),console.log("personFound ",u),null!=u)return!0===r?void function(e,r){var u=n.find((function(n){return n.id===e})),i=Object(f.a)(Object(f.a)({},u),{},{number:r});d.update(e,i).then((function(r){o(n.map((function(n){return n.id!==e?n:r}))),s(t.map((function(n){return n.id!==e?n:r}))),setTimeout((function(){var n="Personid ".concat(e," was updated succesfully");c(n)}),1e3),setTimeout((function(){c(null)}),5e3)})).catch((function(t){a("Person '".concat(u.name,"' was already deleted from server")),setTimeout((function(){a(null)}),5e3),o(n.filter((function(n){return n.id!==e})))}))}(u.id,j.person.number):void 0;var i={name:j.person.name,number:j.person.number,id:n.length+1};d.create(i).then((function(e){o(n.concat(e)),s(n.concat(e)),m({person:{id:0,name:"",number:""}}),setTimeout((function(){var e="Person ".concat(i.name," was created succesfully");c(e)}),1e3),setTimeout((function(){c(null)}),5e3)})).catch((function(e){a("Create person ".concat(i.name," failed.")),setTimeout((function(){a(null)}),5e3)}))},children:[Object(b.jsxs)("div",{children:["Name:",Object(b.jsx)("input",{value:j.person.name,onChange:h,id:"name"})]}),Object(b.jsxs)("div",{children:["Number:",Object(b.jsx)("input",{value:j.person.number,onChange:h,id:"number"})]}),Object(b.jsx)("div",{children:Object(b.jsx)("button",{type:"submit",children:"add"})})]})},m=function(e){var n=e.persons,t=e.setShowAll;return Object(b.jsxs)("div",{children:["Filter shown with",Object(b.jsx)("input",{onChange:function(e){var r=e.target.value;if(void 0!==n&&n.length>0){var o=n.filter((function(e){return e.name.toLowerCase().includes(r.toLowerCase())}));o.length>0?t(o):t([])}}})]})},h=function(e){var n=e.showAll,t=e.persons,r=e.setPersons,o=e.setShowAll,s=e.setInfoMessage,c=e.setErrorMessage;return Object(b.jsx)("div",{children:n.map((function(e){return Object(b.jsxs)("p",{children:[e.name," ",e.number,Object(b.jsx)("button",{onClick:function(){return window.confirm("Delete ".concat(e.name,"?"))&&(u=e.id,void d.remove(u).then((function(e){console.log("response ",e);var c=n.filter((function(e){return e.id!==u}));o(c),c=t.filter((function(e){return e.id!==u})),r(c),setTimeout((function(){var e="Personid ".concat(u," was deleted succesfully");s(e)}),1e3),setTimeout((function(){s(null)}),5e3)})).catch((function(e){c("Personid '".concat(u,"' was already removed from server")),setTimeout((function(){c(null)}),5e3)})));var u},children:"Delete"})]},e.id)}))})},p=function(e){var n=e.infoMessage,t=e.errorMessage;return null===n&&null===t?null:(console.log("infomessage ",n),console.log("errorMessage ",t),null!==n?Object(b.jsx)("div",{className:"info",children:n}):null!==t?Object(b.jsx)("div",{className:"error",children:t}):void 0)},v=function(){var e=Object(r.useState)([]),n=Object(u.a)(e,2),t=n[0],o=n[1],s=Object(r.useState)(null),c=Object(u.a)(s,2),a=c[0],i=c[1],l=Object(r.useState)(null),f=Object(u.a)(l,2),v=f[0],O=f[1];Object(r.useEffect)((function(){d.getAll().then((function(e){o(e),M(e)}))}),[]);var g=Object(r.useState)(t),w=Object(u.a)(g,2),x=w[0],M=w[1];return Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{children:"Phonebook"}),Object(b.jsx)(p,{infoMessage:a,errorMessage:v}),Object(b.jsx)(m,{persons:t,setShowAll:M}),Object(b.jsx)("h2",{children:"Add new"}),Object(b.jsx)(j,{persons:t,showAll:x,setPersons:o,setShowAll:M,setInfoMessage:i,setErrorMessage:O}),Object(b.jsx)("h2",{children:"Numbers"}),Object(b.jsx)(h,{persons:t,showAll:x,setPersons:o,setShowAll:M,setInfoMessage:i,setErrorMessage:O})]})},O=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,41)).then((function(n){var t=n.getCLS,r=n.getFID,o=n.getFCP,s=n.getLCP,c=n.getTTFB;t(e),r(e),o(e),s(e),c(e)}))};c.a.render(Object(b.jsx)(o.a.StrictMode,{children:Object(b.jsx)(v,{})}),document.getElementById("root")),O()}},[[40,1,2]]]);
//# sourceMappingURL=main.b6c00034.chunk.js.map